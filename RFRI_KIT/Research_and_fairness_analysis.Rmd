---
title: "Research Fairness and Research Intergrity"
author: "Dr Joseph B Sempa"
date: "`r Sys.Date()`"
output:
  word_document:
    fig_caption: yes
    toc: yes
  pdf_document:
    fig_caption: yes
    toc: yes
  html_document:
    fig_caption: yes
    toc: yes
  html_notebook:
    toc: yes
always_allow_html: true
classoption: landscape
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(cache=TRUE)
knitr::opts_chunk$set(fig.pos = 'H')
knitr::opts_chunk$set(results = 'asis')
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
library(tidyverse)
library(magrittr)
library(knitr)
library(kableExtra)
library(tinytex)
library(gmodels)
library(readxl)
library(gtsummary)
library(caret)
library(leaps)
library(MASS)
library(predtools)
library(randomForest)
library(mice)
library(psfmi)
```


```{r, message = FALSE, cache = TRUE, warning=FALSE, echo = FALSE, results='asis'}
# library(readr)
pilotstudy_dataset <- read_csv("Research Integrity and Research Fairness Pilot Survey.csv")

```

```{r, message = FALSE, cache = TRUE, warning=FALSE, echo = FALSE, results='asis'}
final_dataset <- rbind(baseline, secondVisit) %>%
  filter(!is.na(pt_id)) %>%
  mutate(group = ifelse((hiv_control == 'control' | hiv_control == 'CONTROL'), 'CONTROL', ifelse(hiv_control == 'HIV' | hiv_control == 'hiv', 'HIV', ''))) %>%
  mutate(gender = as.factor(ifelse((gender == 'N' | gender == 'M'),'M', gender))) %>%
  filter(group!='')
```
# Demographics
```{r, message = FALSE, cache = TRUE, warning=FALSE, echo = FALSE, results='asis'}
dt01 <- final_dataset %>%
  filter(visit == 0) %>%
  mutate(`age of respondents` = cut(age, breaks = c(21,30,40,50,80))) %>%
  dplyr::select(`age of respondents`, gender, group) %>%
  mutate(gender = factor(gender, labels = c('Females', 'Males'))) %>%
  tbl_strata(
    strata = gender,
    .tbl_fun =
      ~ .x %>%
      # tbl_cross(`age of respondents`, group, margin = NULL) %>%
       tbl_summary(by = group, missing = "no") %>% 
      bold_labels() %>%
      add_overall() %>%
        add_n(),
    .header = "**{strata}**, N = {n}"
  )
dt01
```