---
title: "Research Fairness and Research Intergrity: A cross-sectional surevy"
author: "Dr Joseph B Sempa"
date: "`r Sys.Date()`"
output:
  word_document:
    fig_caption: yes
    toc: yes
  pdf_document:
    fig_caption: yes
    toc: yes
  html_document:
    fig_caption: yes
    toc: yes
  html_notebook:
    toc: yes
always_allow_html: true
classoption: landscape
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(cache=TRUE)
knitr::opts_chunk$set(fig.pos = 'H')
knitr::opts_chunk$set(results = 'asis')
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
library(tidyverse)
library(magrittr)
library(knitr)
library(kableExtra)
library(tinytex)
library(gmodels)
library(readxl)
library(gtsummary)
library(caret)
library(leaps)
library(MASS)
library(predtools)
library(randomForest)
library(mice)
library(psfmi)
library(survey)
```


```{r, message = FALSE, cache = TRUE, warning=FALSE, echo = FALSE, results='asis'}
# library(readr)
final_dataset <- read_csv("final_dataset.csv")[-c(19,27,45,122),] %>%
  mutate(`Which of the following best describes you?` = as.factor(ifelse(`Which of the following best describes you?`=='Other (please specify)', 'Researcher from the Global North',  `Which of the following best describes you?`)))
# pilotstudy_dataset <-
#   survey::svydesign(
#     id = ~`Respondent ID`,
#     # weights = ~pw, # target proportion/ actual sample proportion
#     data = dataset#,
#     # fpc = ~fpc # ((Population size-sample size)/(population size-1))^(1/2)
#   )
# negative questions for responsible research practices: 1,3,4,5,7,8,10,11,15,18,19
# negative questions for fair research practices: 1,2,10,12,13
final_dataset <- final_dataset %>%
  mutate(
    rpq1 = case_when(
      `responsible research Practices_q1` == 'Never' ~ 7,
      `responsible research Practices_q1` == 'Very Rarely' ~ 6,
      `responsible research Practices_q1` == 'Rarely' ~ 5,
      `responsible research Practices_q1` == 'Occasionally' ~ 4,
      `responsible research Practices_q1` == 'Frequently' ~ 3,
      `responsible research Practices_q1` == 'Very Frequently' ~ 2,
      `responsible research Practices_q1` == 'Always' ~ 1
    ),
    rpq2 = case_when(
      `responsible research Practices_q2` == 'Never' ~ 1,
      `responsible research Practices_q2` == 'Very Rarely' ~ 2,
      `responsible research Practices_q2` == 'Rarely' ~ 3,
      `responsible research Practices_q2` == 'Occasionally' ~ 4,
      `responsible research Practices_q2` == 'Frequently' ~ 5,
      `responsible research Practices_q2` == 'Very Frequently' ~ 6,
      `responsible research Practices_q2` == 'Always' ~ 7
    ),
    rpq3 = case_when(
      `responsible research Practices_q3` == 'Never' ~ 7,
      `responsible research Practices_q3` == 'Very Rarely' ~ 6,
      `responsible research Practices_q3` == 'Rarely' ~ 5,
      `responsible research Practices_q3` == 'Occasionally' ~ 4,
      `responsible research Practices_q3` == 'Frequently' ~ 3,
      `responsible research Practices_q3` == 'Very Frequently' ~ 2,
      `responsible research Practices_q3` == 'Always' ~ 1
    ),
    rpq4 = case_when(
      `responsible research Practices_q4` == 'Never' ~ 7,
      `responsible research Practices_q4` == 'Very Rarely' ~ 6,
      `responsible research Practices_q4` == 'Rarely' ~ 5,
      `responsible research Practices_q4` == 'Occasionally' ~ 4,
      `responsible research Practices_q4` == 'Frequently' ~ 3,
      `responsible research Practices_q4` == 'Very Frequently' ~ 2,
      `responsible research Practices_q4` == 'Always' ~ 1
    ),
    rpq5 = case_when(
      `responsible research Practices_q5` == 'Never' ~ 7,
      `responsible research Practices_q5` == 'Very Rarely' ~ 6,
      `responsible research Practices_q5` == 'Rarely' ~ 5,
      `responsible research Practices_q5` == 'Occasionally' ~ 4,
      `responsible research Practices_q5` == 'Frequently' ~ 3,
      `responsible research Practices_q5` == 'Very Frequently' ~ 2,
      `responsible research Practices_q5` == 'Always' ~ 1
    ),
    rpq6 = case_when(
      `responsible research Practices_q6` == 'Never' ~ 1,
      `responsible research Practices_q6` == 'Very Rarely' ~ 2,
      `responsible research Practices_q6` == 'Rarely' ~ 3,
      `responsible research Practices_q6` == 'Occasionally' ~ 4,
      `responsible research Practices_q6` == 'Frequently' ~ 5,
      `responsible research Practices_q6` == 'Very Frequently' ~ 6,
      `responsible research Practices_q6` == 'Always' ~ 7
    ),
    rpq7 = case_when(
      `responsible research Practices_q7` == 'Never' ~ 7,
      `responsible research Practices_q7` == 'Very Rarely' ~ 6,
      `responsible research Practices_q7` == 'Rarely' ~ 5,
      `responsible research Practices_q7` == 'Occasionally' ~ 4,
      `responsible research Practices_q7` == 'Frequently' ~ 3,
      `responsible research Practices_q7` == 'Very Frequently' ~ 2,
      `responsible research Practices_q7` == 'Always' ~ 1
    ),
    rpq8 = case_when(
      `responsible research Practices_q8` == 'Never' ~ 7,
      `responsible research Practices_q8` == 'Very Rarely' ~ 6,
      `responsible research Practices_q8` == 'Rarely' ~ 5,
      `responsible research Practices_q8` == 'Occasionally' ~ 4,
      `responsible research Practices_q8` == 'Frequently' ~ 3,
      `responsible research Practices_q8` == 'Very Frequently' ~ 2,
      `responsible research Practices_q8` == 'Always' ~ 1
    ),
    rpq9 = case_when(
      `responsible research Practices_q9` == 'Never' ~ 1,
      `responsible research Practices_q9` == 'Very Rarely' ~ 2,
      `responsible research Practices_q9` == 'Rarely' ~ 3,
      `responsible research Practices_q9` == 'Occasionally' ~ 4,
      `responsible research Practices_q9` == 'Frequently' ~ 5,
      `responsible research Practices_q9` == 'Very Frequently' ~ 6,
      `responsible research Practices_q9` == 'Always' ~ 7
    ),
    rpq10 = case_when(
      `responsible research Practices_q10` == 'Never' ~ 7,
      `responsible research Practices_q10` == 'Very Rarely' ~ 6,
      `responsible research Practices_q10` == 'Rarely' ~ 5,
      `responsible research Practices_q10` == 'Occasionally' ~ 4,
      `responsible research Practices_q10` == 'Frequently' ~ 3,
      `responsible research Practices_q10` == 'Very Frequently' ~ 2,
      `responsible research Practices_q10` == 'Always' ~ 1
    ),
    rpq11 = case_when(
      `responsible research Practices_q11` == 'Never' ~ 7,
      `responsible research Practices_q11` == 'Very Rarely' ~ 6,
      `responsible research Practices_q11` == 'Rarely' ~ 5,
      `responsible research Practices_q11` == 'Occasionally' ~ 4,
      `responsible research Practices_q11` == 'Frequently' ~ 3,
      `responsible research Practices_q11` == 'Very Frequently' ~ 2,
      `responsible research Practices_q11` == 'Always' ~ 1
    ),
    rpq12 = case_when(
      `responsible research Practices_q12` == 'Never' ~ 1,
      `responsible research Practices_q12` == 'Very Rarely' ~ 2,
      `responsible research Practices_q12` == 'Rarely' ~ 3,
      `responsible research Practices_q12` == 'Occasionally' ~ 4,
      `responsible research Practices_q12` == 'Frequently' ~ 5,
      `responsible research Practices_q12` == 'Very Frequently' ~ 6,
      `responsible research Practices_q12` == 'Always' ~ 7
    ),
    rpq13 = case_when(
      `responsible research Practices_q13` == 'Never' ~ 1,
      `responsible research Practices_q13` == 'Very Rarely' ~ 2,
      `responsible research Practices_q13` == 'Rarely' ~ 3,
      `responsible research Practices_q13` == 'Occasionally' ~ 4,
      `responsible research Practices_q13` == 'Frequently' ~ 5,
      `responsible research Practices_q13` == 'Very Frequently' ~ 6,
      `responsible research Practices_q13` == 'Always' ~ 7
    ),
    rpq14 = case_when(
      `responsible research Practices_q14` == 'Never' ~ 1,
      `responsible research Practices_q14` == 'Very Rarely' ~ 2,
      `responsible research Practices_q14` == 'Rarely' ~ 3,
      `responsible research Practices_q14` == 'Occasionally' ~ 4,
      `responsible research Practices_q14` == 'Frequently' ~ 5,
      `responsible research Practices_q14` == 'Very Frequently' ~ 6,
      `responsible research Practices_q14` == 'Always' ~ 7
    ),
    rpq15 = case_when(
      `responsible research Practices_q15` == 'Never' ~ 7,
      `responsible research Practices_q15` == 'Very Rarely' ~ 6,
      `responsible research Practices_q15` == 'Rarely' ~ 5,
      `responsible research Practices_q15` == 'Occasionally' ~ 4,
      `responsible research Practices_q15` == 'Frequently' ~ 3,
      `responsible research Practices_q15` == 'Very Frequently' ~ 2,
      `responsible research Practices_q15` == 'Always' ~ 1
    ),
    rpq16 = case_when(
      `responsible research Practices_q16` == 'Never' ~ 1,
      `responsible research Practices_q16` == 'Very Rarely' ~ 2,
      `responsible research Practices_q16` == 'Rarely' ~ 3,
      `responsible research Practices_q16` == 'Occasionally' ~ 4,
      `responsible research Practices_q16` == 'Frequently' ~ 5,
      `responsible research Practices_q16` == 'Very Frequently' ~ 6,
      `responsible research Practices_q16` == 'Always' ~ 7
    ),
    rpq17 = case_when(
      `responsible research Practices_q17` == 'Never' ~ 1,
      `responsible research Practices_q17` == 'Very Rarely' ~ 2,
      `responsible research Practices_q17` == 'Rarely' ~ 3,
      `responsible research Practices_q17` == 'Occasionally' ~ 4,
      `responsible research Practices_q17` == 'Frequently' ~ 5,
      `responsible research Practices_q17` == 'Very Frequently' ~ 6,
      `responsible research Practices_q17` == 'Always' ~ 7
    ),
    rpq18 = case_when(
      `responsible research Practices_q18` == 'Never' ~ 7,
      `responsible research Practices_q18` == 'Very Rarely' ~ 6,
      `responsible research Practices_q18` == 'Rarely' ~ 5,
      `responsible research Practices_q18` == 'Occasionally' ~ 4,
      `responsible research Practices_q18` == 'Frequently' ~ 3,
      `responsible research Practices_q18` == 'Very Frequently' ~ 2,
      `responsible research Practices_q18` == 'Always' ~ 1
    ),
    rpq19 = case_when(
      `responsible research Practices_q19` == 'Never' ~ 7,
      `responsible research Practices_q19` == 'Very Rarely' ~ 6,
      `responsible research Practices_q19` == 'Rarely' ~ 5,
      `responsible research Practices_q19` == 'Occasionally' ~ 4,
      `responsible research Practices_q19` == 'Frequently' ~ 3,
      `responsible research Practices_q19` == 'Very Frequently' ~ 2,
      `responsible research Practices_q19` == 'Always' ~ 1
    ),
    rpq20 = case_when(
      `responsible research Practices_q20` == 'Never' ~ 1,
      `responsible research Practices_q20` == 'Very Rarely' ~ 2,
      `responsible research Practices_q20` == 'Rarely' ~ 3,
      `responsible research Practices_q20` == 'Occasionally' ~ 4,
      `responsible research Practices_q20` == 'Frequently' ~ 5,
      `responsible research Practices_q20` == 'Very Frequently' ~ 6,
      `responsible research Practices_q20` == 'Always' ~ 7
    )
  ) %>% # 1,2,10,12,13
  mutate(
    fpq1 = case_when(
      `fair research practices_q1` == 'Never' ~ 7,
      `fair research practices_q1` == 'Very Rarely' ~ 6,
      `fair research practices_q1` == 'Rarely' ~ 5,
      `fair research practices_q1` == 'Occasionally' ~ 4,
      `fair research practices_q1` == 'Frequently' ~ 3,
      `fair research practices_q1` == 'Very Frequently' ~ 2,
      `fair research practices_q1` == 'Always' ~ 1
    ),
    fpq2 = case_when(
      `fair research practices_q2` == 'Never' ~ 7,
      `fair research practices_q2` == 'Very Rarely' ~ 6,
      `fair research practices_q2` == 'Rarely' ~ 5,
      `fair research practices_q2` == 'Occasionally' ~ 4,
      `fair research practices_q2` == 'Frequently' ~ 3,
      `fair research practices_q2` == 'Very Frequently' ~ 2,
      `fair research practices_q2` == 'Always' ~ 1
    ),
    fpq3 = case_when(
      `fair research practices_q3` == 'Never' ~ 1,
      `fair research practices_q3` == 'Very Rarely' ~ 2,
      `fair research practices_q3` == 'Rarely' ~ 3,
      `fair research practices_q3` == 'Occasionally' ~ 4,
      `fair research practices_q3` == 'Frequently' ~ 5,
      `fair research practices_q3` == 'Very Frequently' ~ 6,
      `fair research practices_q3` == 'Always' ~ 7
    ),
    fpq4 = case_when(
      `fair research practices_q4` == 'Never' ~ 1,
      `fair research practices_q4` == 'Very Rarely' ~ 2,
      `fair research practices_q4` == 'Rarely' ~ 3,
      `fair research practices_q4` == 'Occasionally' ~ 4,
      `fair research practices_q4` == 'Frequently' ~ 5,
      `fair research practices_q4` == 'Very Frequently' ~ 6,
      `fair research practices_q4` == 'Always' ~ 7
    ),
    fpq5 = case_when(
      `fair research practices_q5` == 'Never' ~ 1,
      `fair research practices_q5` == 'Very Rarely' ~ 2,
      `fair research practices_q5` == 'Rarely' ~ 3,
      `fair research practices_q5` == 'Occasionally' ~ 4,
      `fair research practices_q5` == 'Frequently' ~ 5,
      `fair research practices_q5` == 'Very Frequently' ~ 6,
      `fair research practices_q5` == 'Always' ~ 7
    ),
    fpq6 = case_when(
      `fair research practices_q6` == 'Never' ~ 1,
      `fair research practices_q6` == 'Very Rarely' ~ 2,
      `fair research practices_q6` == 'Rarely' ~ 3,
      `fair research practices_q6` == 'Occasionally' ~ 4,
      `fair research practices_q6` == 'Frequently' ~ 5,
      `fair research practices_q6` == 'Very Frequently' ~ 6,
      `fair research practices_q6` == 'Always' ~ 7
    ),
    fpq7 = case_when(
      `fair research practices_q7` == 'Never' ~ 1,
      `fair research practices_q7` == 'Very Rarely' ~ 2,
      `fair research practices_q7` == 'Rarely' ~ 3,
      `fair research practices_q7` == 'Occasionally' ~ 4,
      `fair research practices_q7` == 'Frequently' ~ 5,
      `fair research practices_q7` == 'Very Frequently' ~ 6,
      `fair research practices_q7` == 'Always' ~ 7
    ),
    fpq8 = case_when(
      `fair research practices_q8` == 'Never' ~ 1,
      `fair research practices_q8` == 'Very Rarely' ~ 2,
      `fair research practices_q8` == 'Rarely' ~ 3,
      `fair research practices_q8` == 'Occasionally' ~ 4,
      `fair research practices_q8` == 'Frequently' ~ 5,
      `fair research practices_q8` == 'Very Frequently' ~ 6,
      `fair research practices_q8` == 'Always' ~ 7
    ),
    fpq9 = case_when(
      `fair research practices_q9` == 'Never' ~ 1,
      `fair research practices_q9` == 'Very Rarely' ~ 2,
      `fair research practices_q9` == 'Rarely' ~ 3,
      `fair research practices_q9` == 'Occasionally' ~ 4,
      `fair research practices_q9` == 'Frequently' ~ 5,
      `fair research practices_q9` == 'Very Frequently' ~ 6,
      `fair research practices_q9` == 'Always' ~ 7
    ),
    fpq10 = case_when(
      `fair research practices_q10` == 'Never' ~ 7,
      `fair research practices_q10` == 'Very Rarely' ~ 6,
      `fair research practices_q10` == 'Rarely' ~ 5,
      `fair research practices_q10` == 'Occasionally' ~ 4,
      `fair research practices_q10` == 'Frequently' ~ 3,
      `fair research practices_q10` == 'Very Frequently' ~ 2,
      `fair research practices_q10` == 'Always' ~ 1
    ),
    fpq11 = case_when(
      `fair research practices_q11` == 'Never' ~ 1,
      `fair research practices_q11` == 'Very Rarely' ~ 2,
      `fair research practices_q11` == 'Rarely' ~ 3,
      `fair research practices_q11` == 'Occasionally' ~ 4,
      `fair research practices_q11` == 'Frequently' ~ 5,
      `fair research practices_q11` == 'Very Frequently' ~ 6,
      `fair research practices_q11` == 'Always' ~ 7
    ),
    fpq12 = case_when(
      `fair research practices_q12` == 'Never' ~ 7,
      `fair research practices_q12` == 'Very Rarely' ~ 6,
      `fair research practices_q12` == 'Rarely' ~ 5,
      `fair research practices_q12` == 'Occasionally' ~ 4,
      `fair research practices_q12` == 'Frequently' ~ 3,
      `fair research practices_q12` == 'Very Frequently' ~ 2,
      `fair research practices_q12` == 'Always' ~ 1
    ),
    fpq13 = case_when(
      `fair research practices_q13` == 'Never' ~ 7,
      `fair research practices_q13` == 'Very Rarely' ~ 6,
      `fair research practices_q13` == 'Rarely' ~ 5,
      `fair research practices_q13` == 'Occasionally' ~ 4,
      `fair research practices_q13` == 'Frequently' ~ 3,
      `fair research practices_q13` == 'Very Frequently' ~ 2,
      `fair research practices_q13` == 'Always' ~ 1
    ),
    fpq14 = case_when(
      `fair research practices_q14` == 'Never' ~ 1,
      `fair research practices_q14` == 'Very Rarely' ~ 2,
      `fair research practices_q14` == 'Rarely' ~ 3,
      `fair research practices_q14` == 'Occasionally' ~ 4,
      `fair research practices_q14` == 'Frequently' ~ 5,
      `fair research practices_q14` == 'Very Frequently' ~ 6,
      `fair research practices_q14` == 'Always' ~ 7
    ),
    fpq15 = case_when(
      `fair research practices_q15` == 'Never' ~ 1,
      `fair research practices_q15` == 'Very Rarely' ~ 2,
      `fair research practices_q15` == 'Rarely' ~ 3,
      `fair research practices_q15` == 'Occasionally' ~ 4,
      `fair research practices_q15` == 'Frequently' ~ 5,
      `fair research practices_q15` == 'Very Frequently' ~ 6,
      `fair research practices_q15` == 'Always' ~ 7
    ),
    fpq16 = case_when(
      `fair research practices_q16` == 'Never' ~ 1,
      `fair research practices_q16` == 'Very Rarely' ~ 2,
      `fair research practices_q16` == 'Rarely' ~ 3,
      `fair research practices_q16` == 'Occasionally' ~ 4,
      `fair research practices_q16` == 'Frequently' ~ 5,
      `fair research practices_q16` == 'Very Frequently' ~ 6,
      `fair research practices_q16` == 'Always' ~ 7
    ),
    fpq17 = case_when(
      `fair research practices_q17` == 'Never' ~ 1,
      `fair research practices_q17` == 'Very Rarely' ~ 2,
      `fair research practices_q17` == 'Rarely' ~ 3,
      `fair research practices_q17` == 'Occasionally' ~ 4,
      `fair research practices_q17` == 'Frequently' ~ 5,
      `fair research practices_q17` == 'Very Frequently' ~ 6,
      `fair research practices_q17` == 'Always' ~ 7
    ),
    fpq18 = case_when(
      `fair research practices_q18` == 'Never' ~ 1,
      `fair research practices_q18` == 'Very Rarely' ~ 2,
      `fair research practices_q18` == 'Rarely' ~ 3,
      `fair research practices_q18` == 'Occasionally' ~ 4,
      `fair research practices_q18` == 'Frequently' ~ 5,
      `fair research practices_q18` == 'Very Frequently' ~ 6,
      `fair research practices_q18` == 'Always' ~ 7
    ),
    fpq19 = case_when(
      `fair research practices_q19` == 'Never' ~ 1,
      `fair research practices_q19` == 'Very Rarely' ~ 2,
      `fair research practices_q19` == 'Rarely' ~ 3,
      `fair research practices_q19` == 'Occasionally' ~ 4,
      `fair research practices_q19` == 'Frequently' ~ 5,
      `fair research practices_q19` == 'Very Frequently' ~ 6,
      `fair research practices_q19` == 'Always' ~ 7
    ),
    fpq20 = case_when(
      `fair research practices_q20` == 'Never' ~ 1,
      `fair research practices_q20` == 'Very Rarely' ~ 2,
      `fair research practices_q20` == 'Rarely' ~ 3,
      `fair research practices_q20` == 'Occasionally' ~ 4,
      `fair research practices_q20` == 'Frequently' ~ 5,
      `fair research practices_q20` == 'Very Frequently' ~ 6,
      `fair research practices_q20` == 'Always' ~ 7
    )
  ) %>%
  rowwise() %>%
  mutate(
    rpq = sum(c(rpq1, rpq2, rpq3, rpq4, rpq5, rpq6, rpq7, rpq8, rpq9, rpq10, rpq11, rpq12, rpq13, rpq14, rpq15, rpq16, rpq17, rpq18, rpq19, rpq20), na.rm = T),
    fpq = sum(c(fpq1, fpq2, fpq3, fpq4, fpq5, fpq6, fpq7, fpq8, fpq9, fpq10, fpq11, fpq12, fpq13, fpq14, fpq15, fpq16, fpq17, fpq18, fpq19, fpq20), na.rm = T)
  ) %>%
  mutate(`responsible research Practices score` = ifelse(rpq == 0, NA, rpq),
         `fair research practices score` = ifelse(fpq == 0, NA, fpq))
# g=final_dataset %>%
#   dplyr::select(`responsible research Practices_q1`, rpq1, `responsible research Practices_q2`, rpq2, `responsible research Practices_q8`, rpq8, `responsible research Practices_q14`, rpq14, `responsible research Practices_q18`, rpq18,
#                 `fair research practices_q1`, fpq1, `fair research practices_q5`, fpq5, `fair research practices_q9`, fpq9, `fair research practices_q10`, fpq10, `fair research practices_q12`, fpq12, `fair research practices_q14`, fpq14, `fair research practices_q17`, fpq17)
# x= final_dataset%>%
#   dplyr::select(rpq1, rpq2, rpq3, rpq4, rpq5, rpq6, rpq7, rpq8, rpq9, rpq10, rpq11, rpq12, rpq13, rpq14, rpq15, rpq16, rpq17, rpq18, rpq19, rpq20, fpq1, fpq2, fpq3, fpq4, fpq5, fpq6, fpq7, fpq8, fpq9, fpq10, fpq11, fpq12, fpq13, fpq14, fpq15, fpq16, fpq17, fpq18, fpq19, fpq20, `responsible research Practices score`, `fair research practices score`, rpq, fpq) #%>%
#   rowwise() %>%
# mutate(fp = sum(c(fpq1, fpq2, fpq3, fpq4, fpq5, fpq6, fpq7, fpq8, fpq9, fpq10, fpq11, fpq12, fpq13, fpq14, fpq15, fpq16, fpq17, fpq18, fpq19, fpq20), na.rm = T))

```

# Demographics
```{r, message = FALSE, cache = TRUE, warning=FALSE, echo = FALSE, results='asis'}
dt01 <- final_dataset %>%
  dplyr::select(`Which country are you from?`, `What discipline of global health based describes you:`, `What is you gender?`, `How many years of involvement in research do you have?`, `Which of the following best describes you?`, `What is your highest academic rank?`) %>%
  # mutate(gender = factor(gender, labels = c('Females', 'Males'))) %>%
  tbl_summary(by = `Which of the following best describes you?`,
            digits = list(all_categorical() ~ c(0, 1))#, 
            # missing = "no",
            # statistic = list(all_continuous() ~ "{mean} ({sd})")
            ) %>% 
  add_overall() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()

dt01
```
Out of the 145 respondents, only 118 people responded to the question about country of origin. Majority 41 (34.7%) were from sub-Saharan Africa working many of whom were based in the global south. The second highest group were from Europe and Central Asia, with 32 (27.1%), many of whom work were based in the global north. Only one person was from the middle-East and North America, currently based in the global south. However, 27 (18.6%) respondents did not respond to this question.

Majority, 41 (35.3%) of the respondents were from Biostatistics/Epidemiology discipline of global health of whom majority twenty-two were operating from the global south, accounting for 34.4% from the global south. Biology/medicine was the second highest global heal discipline among our respondents with 23 (27.6%) and was also the second highest among country of origin with 18 (28.1%) from the global south. Only one respondent was from the Mathematics/computer science discipline and based in global north. However, we had 29 (20%) non-response rate on this question.

Majority of the respondents 59 (50.4%) were of the male-gender, accounting for 37 (56.9%) from the global south. The global south still had majority 28 (43.1%)female-gender representation. However, 28 (19.3%) respondents did not respond to this question.

Majority of the respondents 65 (55.6%) were established researchers with >10years post education, accounting for 35 (74.5%) from the global north. The Mid-career (3-10 years post-education) were the second highest 36 (30.8%), accounting for 27 (42.2%) based in the global south. However, we had 28 (19.3%) non-response rate on this question.

For the highest academic rank, we had a non-response rate of 27 (18.6%). however, majority of the respondents 34 (28.8%) had Ph.D degrees, accounting for 23 (35.4%) from the global south. The Associate Professor or Full Professor were the second highest 33 (28.0%), accounting for 20 (42.6%) from the global south. However, we had 28 (19.3%) non-response rate on this question. Respondents with a bachelor or Master degree were 29 (24.6%), accounting for 21 (32.3%) from the global south.

# Prevalence of responsible research practices and Fair research practices 

<!-- We used a cutoff score of 70 in both cases since the maximum score is 140 in both cases. -->
```{r, message = FALSE, cache = TRUE, warning=FALSE, echo = FALSE, results='asis'}
dt1 <- final_dataset %>%
  dplyr::select(rpq1, rpq2, rpq3, rpq4, rpq5, rpq6, rpq7, rpq8, rpq9, rpq10, rpq11, rpq12, rpq13, rpq14, rpq15, rpq16, rpq17, rpq18, rpq19, rpq20, fpq1, fpq2, fpq3, fpq4, fpq5, fpq6, fpq7, fpq8, fpq9, fpq10, fpq11, fpq12, fpq13, fpq14, fpq15, fpq16, fpq17, fpq18, fpq19, fpq20, `responsible research Practices score`, `fair research practices score`, `Which of the following best describes you?`) 
col_to_change <- c('rpq1', 'rpq2', 'rpq3', 'rpq4', 'rpq5', 'rpq6', 'rpq7', 'rpq8', 'rpq9', 'rpq10', 'rpq11', 'rpq12', 'rpq13', 'rpq14', 'rpq15', 'rpq16', 'rpq17', 'rpq18', 'rpq19', 'rpq20', 'fpq1', 'fpq2', 'fpq3', 'fpq4', 'fpq5', 'fpq6', 'fpq7', 'fpq8', 'fpq9', 'fpq10', 'fpq11', 'fpq12', 'fpq13', 'fpq14', 'fpq15', 'fpq16', 'fpq17', 'fpq18', 'fpq19', 'fpq20')
change_to <- c(1,2,3)
dt1[col_to_change] <- sapply(dt1[col_to_change],  # Replace values in certain columns
                              function(x) replace(x, x %in% change_to, 1))
change_to <- c(4,5,6,7,8)
dt1[col_to_change] <- sapply(dt1[col_to_change],  # Replace values in certain columns
                              function(x) replace(x, x %in% change_to, 0))
# change_to <- c(8)
# dt1[col_to_change] <- sapply(dt1[col_to_change],  # Replace values in certain columns
#                               function(x) replace(x, x %in% change_to, 2))
dt2 <-dt1 %>%
  mutate(
    rpq = sum(c(rpq1, rpq2, rpq3, rpq4, rpq5, rpq6, rpq7, rpq8, rpq9, rpq10, rpq11, rpq12, rpq13, rpq14, rpq15, rpq16, rpq17, rpq18, rpq19, rpq20), na.rm = T),
    fpq = sum(c(fpq1, fpq2, fpq3, fpq4, fpq5, fpq6, fpq7, fpq8, fpq9, fpq10, fpq11, fpq12, fpq13, fpq14, fpq15, fpq16, fpq17, fpq18, fpq19, fpq20), na.rm = T)
  ) %>%
  mutate(`responsible research Practices` = ifelse(rpq > 10, 'Fail', ifelse(rpq <= 10, 'Pass', 'NA')),
         `fair research practices` = ifelse(fpq > 10, 'Fail', ifelse(fpq <= 10, 'Pass', 'NA'))) %>%
  mutate(`responsible research Practices` = as.character(ifelse(is.na(`responsible research Practices score`), '', `responsible research Practices`)),
         `fair research practices` = as.character(ifelse(is.na(`fair research practices score`), '', `fair research practices`))
         ) %>%
  mutate(`responsible research Practices` = as.factor(ifelse(`responsible research Practices`=='', NA, `responsible research Practices`)),
         `fair research practices` = as.factor(ifelse(`fair research practices`=='', NA, `fair research practices`))) %>%
  dplyr::select(`responsible research Practices`, `fair research practices`, `Which of the following best describes you?`) %>%
  tbl_summary(by = `Which of the following best describes you?`,
            digits = list(all_categorical() ~ c(0, 1))#, 
            # missing = "no",
            # statistic = list(all_continuous() ~ "{mean} ({sd})")
            ) %>% 
  add_overall() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt2

# dt2 <- final_dataset %>%
#   mutate(location = as.factor(case_when(
#     `Which of the following best describes you?` == 'Researcher from the Global North' ~ 'Global North',
#     `Which of the following best describes you?` == 'Researcher from the Global South' ~ 'Global South'#,
#     # `Which of the following best describes you?` == '' ~ 'Global North',
#   ))) %>%
#   mutate(`responsible research Practices score` = as.factor(ifelse(`responsible research Practices score`>=70, 'Pass', ifelse(`responsible research Practices score`<70, 'Fail', 'NA'))),
#          `fair research practices score` = as.factor(ifelse(`fair research practices score`>=70, 'Pass', ifelse(`fair research practices score`<70, 'Fail', 'NA')))) %>%
#   dplyr::select(`responsible research Practices score`, `fair research practices score`, location) %>%
#   tbl_summary(by = location, 
#             missing = "no",
#             # statistic = list(all_continuous() ~ "{mean} ({sd})")
#             ) %>% 
#   add_p() %>%
#   add_n() %>% 
#   modify_header(label = "Variable") %>% # update the column header
#   bold_labels()
# dt2
```
Of the 145 respondents to the survey, 126 (86.9%) filled in the responsible research practices (RRP) questionnaire. Using a cutoff score of 70, which is the half the total possible score on the RRP tool, all respondents to this questionnaire from the global south and global north passed the questions and there was no statistically significant difference in the median score between global south 111 (95, 123) compared to global north 107 (97, 117) (P = 0.4). While, for fair research practices, with the same cutoff conditions and a response rate of 116 (80%), an equal number of two individuals failed and there was a statistically significant difference in the median score between global south 116 (99, 127) compared to global north 104 (90, 118) (P = 0.010).

<!-- # Responsible research practices and fair research practices by the question which of the following best describes you? -->
<!-- ```{r, message = FALSE, cache = TRUE, warning=FALSE, echo = FALSE, results='asis'} -->
<!-- dt02 <- final_dataset %>% -->
<!--   dplyr::select(rpq1, rpq2, rpq3, rpq4, rpq5, rpq6, rpq7, rpq8, rpq9, rpq10, rpq11, rpq12, rpq13, rpq14, rpq15, rpq16, rpq17, rpq18, rpq19, rpq20, fpq1, fpq2, fpq3, fpq4, fpq5, fpq6, fpq7, fpq8, fpq9, fpq10, fpq11, fpq12, fpq13, fpq14, fpq15, fpq16, fpq17, fpq18, fpq19, fpq20, `responsible research Practices score`, `fair research practices score`, `Which of the following best describes you?`) %>% -->
<!--   tbl_summary(by = `Which of the following best describes you?`,  -->
<!--             # missing = "no", -->
<!--             type = list(c('rpq1', 'rpq2', 'rpq3', 'rpq4', 'rpq5', 'rpq6', 'rpq7', 'rpq8', 'rpq9', 'rpq10', 'rpq11', 'rpq12', 'rpq13', 'rpq14', 'rpq15', 'rpq16', 'rpq17', 'rpq18', 'rpq19', 'rpq20', 'fpq1', 'fpq2', 'fpq3', 'fpq4', 'fpq5', 'fpq6', 'fpq7', 'fpq8', 'fpq9', 'fpq10', 'fpq11', 'fpq12', 'fpq13', 'fpq14', 'fpq15', 'fpq16', 'fpq17', 'fpq18', 'fpq19', 'fpq20', 'responsible research Practices score', 'fair research practices score') ~ 'continuous'), -->
<!--             statistic = list(c('rpq1', 'rpq2', 'rpq3', 'rpq4', 'rpq5', 'rpq6', 'rpq7', 'rpq8', 'rpq9', 'rpq10', 'rpq11', 'rpq12', 'rpq13', 'rpq14', 'rpq15', 'rpq16', 'rpq17', 'rpq18', 'rpq19', 'rpq20', 'fpq1', 'fpq2', 'fpq3', 'fpq4', 'fpq5', 'fpq6', 'fpq7', 'fpq8', 'fpq9', 'fpq10', 'fpq11', 'fpq12', 'fpq13', 'fpq14', 'fpq15', 'fpq16', 'fpq17', 'fpq18', 'fpq19', 'fpq20', 'responsible research Practices score', 'fair research practices score') ~ "{median} ({p25}, {p75})") -->
<!--             ) %>%  -->
<!--   # add_p() %>% -->
<!--   add_n() %>%  -->
<!--   modify_header(label = "Variable") %>% # update the column header -->
<!--   bold_labels() -->
<!-- dt02 -->
<!-- ``` -->

# Responsible research practices and fair research practices by location (Global North or South)

In this analysis, I have removed those who chose the option prefer not to say
```{r, message = FALSE, cache = TRUE, warning=FALSE, echo = FALSE, results='asis'}
dt03 <- final_dataset %>%
  mutate(location = as.factor(case_when(
    `Which of the following best describes you?` == 'Researcher from the Global North' ~ 'Global North',
    `Which of the following best describes you?` == 'Researcher from the Global South' ~ 'Global South'#,
    # `Which of the following best describes you?` == '' ~ 'Global North',
  ))) %>%
  dplyr::select(rpq1, rpq2, rpq3, rpq4, rpq5, rpq6, rpq7, rpq8, rpq9, rpq10, rpq11, rpq12, rpq13, rpq14, rpq15, rpq16, rpq17, rpq18, rpq19, rpq20, fpq1, fpq2, fpq3, fpq4, fpq5, fpq6, fpq7, fpq8, fpq9, fpq10, fpq11, fpq12, fpq13, fpq14, fpq15, fpq16, fpq17, fpq18, fpq19, fpq20, `responsible research Practices score`, `fair research practices score`, location) %>%
  tbl_summary(by = location, 
            # missing = "no",
            type = list(c('rpq1', 'rpq2', 'rpq3', 'rpq4', 'rpq5', 'rpq6', 'rpq7', 'rpq8', 'rpq9', 'rpq10', 'rpq11', 'rpq12', 'rpq13', 'rpq14', 'rpq15', 'rpq16', 'rpq17', 'rpq18', 'rpq19', 'rpq20', 'fpq1', 'fpq2', 'fpq3', 'fpq4', 'fpq5', 'fpq6', 'fpq7', 'fpq8', 'fpq9', 'fpq10', 'fpq11', 'fpq12', 'fpq13', 'fpq14', 'fpq15', 'fpq16', 'fpq17', 'fpq18', 'fpq19', 'fpq20', 'responsible research Practices score', 'fair research practices score',) ~ 'continuous'),
            statistic = list(c('rpq1', 'rpq2', 'rpq3', 'rpq4', 'rpq5', 'rpq6', 'rpq7', 'rpq8', 'rpq9', 'rpq10', 'rpq11', 'rpq12', 'rpq13', 'rpq14', 'rpq15', 'rpq16', 'rpq17', 'rpq18', 'rpq19', 'rpq20', 'fpq1', 'fpq2', 'fpq3', 'fpq4', 'fpq5', 'fpq6', 'fpq7', 'fpq8', 'fpq9', 'fpq10', 'fpq11', 'fpq12', 'fpq13', 'fpq14', 'fpq15', 'fpq16', 'fpq17', 'fpq18', 'fpq19', 'fpq20', 'responsible research Practices score', 'fair research practices score') ~ "{median} ({p25}, {p75})")
            ) %>% 
  add_p(test = everything() ~ "wilcox.test") %>%
  add_overall() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt03


```

About responsible research practices, when respondents were asked whether in the last three years, they gave *insufficient* attention to the skills or expertise essential to perform my studies, global south respondents had a significantly higher score 7.00 (6.00, 7.00) compared to the global north 6.00 (5.75, 7.00) (P = 0.040). When asked whether In the last three years, I *insufficiently* supervised or mentored junior co-workers had a significantly higher score 7.00 (6.00, 7.00) compared to the global north 6.00 (5.00, 7.00) (P = 0.002). There were no statistically significant differences in all other 18 questions in the Responsible research practices.

About fair research practices, when respondents were asked whether in the research they have been involved in over the last three years, they did not consult representatives of affected populations during the preparation stage of research, global south respondents had a significantly higher score 7.00 (6.00, 7.00) compared to the global north 5.00 (3.00, 6.00) (P <0.001). When asked whether in the research they have been involved in over the last three years, they did not consult end users of research during the preparation stage of research, the global south had a significantly higher score 6.00 (4.00, 7.00) compared to the global north 5.00 (4.00, 6.00) (P = 0.032). When asked whether in the research they have been involved in over the last three years there were clear *decision-making processes* agreed upon by all study partners, the global south had a significantly higher score 7.00 (6.00, 7.00) compared to the global north 6.00 (5.00, 6.50) (P = 0.003). When asked whether in the research they have been involved in over the last three years there were no clear and fair data ownership agreements, the global south had a significantly higher score 7.00 (6.00, 7.00) compared to the global north 6.00 (5.00, 7.00) (P = 0.045). When asked whether in the research they have been involved in over the last three years, whenever data was made openly accessible, strategies were put in place to encourage secondary analyses by local researchers, the global south had a significantly higher score 6.00 (3.25, 7.00) compared to the global north 4.00 (3.00, 6.00) (P = 0.037). There were no statistically significant differences in all other 15 questions in the Fair research practices.

# Multivariate model - responsible research Practices

```{r, message = FALSE, cache = TRUE, warning=FALSE, echo = FALSE, results='asis'}

dat <- final_dataset %>%
  mutate(Location = as.factor(case_when(
    `Which of the following best describes you?` == 'Researcher from the Global North' ~ 'Global North',
    `Which of the following best describes you?` == 'Researcher from the Global South' ~ 'Global South'#,
    # `Which of the following best describes you?` == '' ~ 'Global North',
  ))) %>%
  drop_na(c('Which country are you from?', 'What discipline of global health based describes you:', 'What is you gender?', 'How many years of involvement in research do you have?', 'Which of the following best describes you?', 'What is your highest academic rank?', 'responsible research Practices score', 'fair research practices score', 'Location')) %>%
  dplyr::select(`Which country are you from?`, `What discipline of global health based describes you:`, `What is you gender?`, `How many years of involvement in research do you have?`, Location, `What is your highest academic rank?`, `responsible research Practices score`, `fair research practices score`, ) 
univariate_table <- dat %>%
  mutate(rpq_score = `responsible research Practices score`) %>%
  mutate(
    accademic_rank = as.factor(`What is your highest academic rank?`),
    year_involment_research = as.factor(`How many years of involvement in research do you have?`),
    gender = as.factor(`What is you gender?`),
    country_origin = as.factor(`Which country are you from?`),
    discipline_global_health = as.factor(`What discipline of global health based describes you:`)
  ) %>%
  dplyr::select(rpq_score, Location, accademic_rank, year_involment_research, gender, country_origin, discipline_global_health) # %>%
univariate_table_1 <- 
tbl_uvregression(
  univariate_table[c("rpq_score", "Location", "accademic_rank", "year_involment_research", "gender", "country_origin", "discipline_global_health")],
  method = glm,
  y = "rpq_score",
  method.args = list(family = gaussian),
  exponentiate = FALSE
)
univariate_table_1
finalmodel_dataset <- dat %>%
  mutate(rpq_score = `responsible research Practices score`
         )%>%
  dplyr::select(rpq_score, Location, `What is your highest academic rank?`, `How many years of involvement in research do you have?`, `What is you gender?`, `Which country are you from?`, `What discipline of global health based describes you:`) %>%
  mutate(accademic_rank = as.factor(`What is your highest academic rank?`),
         year_involment_research = as.factor(`How many years of involvement in research do you have?`),
         gender = as.factor(`What is you gender?`),
         country_origin = as.factor(`Which country are you from?`),
         discipline_global_health = as.factor(`What discipline of global health based describes you:`)
         ) %>%
  dplyr::select(rpq_score, Location, accademic_rank, year_involment_research, gender, country_origin, discipline_global_health)

model <- glm(formula = as.formula('rpq_score~ Location + accademic_rank + year_involment_research + gender + country_origin + discipline_global_health'),
              data = finalmodel_dataset,
              family = gaussian,
              )

step.model <- stepAIC(model, direction = "both", 
                      trace = F)
# summary(step.model)
model1 <- glm(formula = as.formula('rpq_score~ Location + accademic_rank'),
              data = finalmodel_dataset,
              family = gaussian,
              )
m1 <-model1 %>%
  tbl_regression(
    estimate_fun = purrr::partial(style_ratio, digits = 2),# exponentiate = F, 
    pvalue_fun = ~style_pvalue(.x, digits = 3),
  ) %>% 
  # add_global_p() %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  as_gt() %>%
  gt::tab_source_note(gt::md("*Best set of dependent variables*")) %>%
  gt::gtsave(filename = "rrpq.pdf")
  # gt::gtsave(filename = "rrpq.rtf")

# full model
finalmodel_dataset2 <- dat %>%
  mutate(rpq_score = `responsible research Practices score`
         )%>%
  # dplyr::select(rpq_score, Location, var_selected) %>%
  mutate(accademic_rank = as.factor(`What is your highest academic rank?`),
         year_involment_research = as.factor(`How many years of involvement in research do you have?`),
         gender = as.factor(`What is you gender?`),
         country_origin = as.factor(`Which country are you from?`),
         discipline_global_health = as.factor(`What discipline of global health based describes you:`)
         ) %>%
  dplyr::select(rpq_score, Location, accademic_rank, year_involment_research, gender, country_origin, discipline_global_health)
model2 <- glm(formula = as.formula('rpq_score~ Location + accademic_rank + year_involment_research + gender + country_origin + discipline_global_health'),
              data = finalmodel_dataset2,
              family = gaussian,
              )

m2 <- model2 %>%
  tbl_regression(
    estimate_fun = purrr::partial(style_ratio, digits = 2),# exponentiate = F, 
    pvalue_fun = ~style_pvalue(.x, digits = 3),
  ) %>% 
  # add_global_p() %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  as_gt() %>%
  gt::tab_source_note(gt::md("*Full model*")) %>%
  gt::gtsave(filename = "rrpq - full model.pdf")
  # gt::gtsave(filename = "rrpq - full model.rtf")
```
At Univariate analysis, only academic rank of the respondents had a category that was significantly associated with responsible research practices. Bachelor or Master degree was associated with -17 (95%CI:-27, -6.9)	(P = 0.001) reduction in the responsible research score compared to Associate Professor or Full Professor. Other variables were not statistically significantly associated with responsible research practices. In the full model, after adjusting for Location, years of involvement, gender, country of origin and discipline of global health, Bachelor or Master degree was associated with -16.5 (95%CI:-30.6, -2.29) (P = 0.025) reduction in the responsible research practice score compared to Associate Professor or Full Professor. While in the reduced model (after stepwise regression analysis) Bachelor or Master degree was still associated with -18.3 (95%CI:-28.7, -7.84)	(P <0.001) reduction in the responsible research score compared to Associate Professor or Full Professor adjusting for location.


# Multivariate model - Fair research Practices

```{r, message = FALSE, cache = TRUE, warning=FALSE, echo = FALSE, results='asis'}
dat <- final_dataset %>%
  mutate(Location = as.factor(case_when(
    `Which of the following best describes you?` == 'Researcher from the Global North' ~ 'Global North',
    `Which of the following best describes you?` == 'Researcher from the Global South' ~ 'Global South'#,
    # `Which of the following best describes you?` == '' ~ 'Global North',
  ))) %>%
  drop_na(c('Which country are you from?', 'What discipline of global health based describes you:', 'What is you gender?', 'How many years of involvement in research do you have?', 'Which of the following best describes you?', 'What is your highest academic rank?', 'responsible research Practices score', 'fair research practices score', 'Location')) %>%
  dplyr::select(`Which country are you from?`, `What discipline of global health based describes you:`, `What is you gender?`, `How many years of involvement in research do you have?`, Location, `What is your highest academic rank?`, `responsible research Practices score`, `fair research practices score`) 

univariate_table_2 <- dat %>%
  mutate(fpq_score = `fair research practices score`
         )%>%
  dplyr::select(fpq_score, Location, `What is your highest academic rank?`, `How many years of involvement in research do you have?`, `What is you gender?`, `Which country are you from?`, `What discipline of global health based describes you:`) %>%
  mutate(accademic_rank = as.factor(`What is your highest academic rank?`),
         year_involment_research = as.factor(`How many years of involvement in research do you have?`),
         gender = as.factor(`What is you gender?`),
         country_origin = as.factor(`Which country are you from?`),
         discipline_global_health = as.factor(`What discipline of global health based describes you:`)
         ) %>%
  dplyr::select(fpq_score, Location, accademic_rank, year_involment_research, gender, country_origin, discipline_global_health)
univariate_table_3 <- 
tbl_uvregression(
  univariate_table_2[c("fpq_score", "Location", "accademic_rank", "year_involment_research", "gender", "country_origin", "discipline_global_health")],
  method = glm,
  y = "fpq_score",
  method.args = list(family = gaussian),
  exponentiate = FALSE
)
univariate_table_3

finalmodel_dataset <- dat %>%
  mutate(fpq_score = `fair research practices score`
         )%>%
  dplyr::select(fpq_score, Location, `What is your highest academic rank?`, `How many years of involvement in research do you have?`, `What is you gender?`, `Which country are you from?`, `What discipline of global health based describes you:`) %>%
  mutate(accademic_rank = as.factor(`What is your highest academic rank?`),
         year_involment_research = as.factor(`How many years of involvement in research do you have?`),
         gender = as.factor(`What is you gender?`),
         country_origin = as.factor(`Which country are you from?`),
         discipline_global_health = as.factor(`What discipline of global health based describes you:`)
         ) %>%
  dplyr::select(fpq_score, Location, accademic_rank, year_involment_research, gender, country_origin, discipline_global_health)

model3 <- glm(formula = as.formula('fpq_score~ Location + accademic_rank + year_involment_research + gender + country_origin + discipline_global_health'),
              data = finalmodel_dataset,
              family = gaussian,
              )

step.model <- stepAIC(model3, direction = "both", 
                      trace = F)
summary(step.model)
model3 <- glm(formula = as.formula('fpq_score~ Location + year_involment_research'),
              data = finalmodel_dataset,
              family = gaussian,
              )

model3 %>%
  tbl_regression(
    estimate_fun = purrr::partial(style_ratio, digits = 2),# exponentiate = F, 
    pvalue_fun = ~style_pvalue(.x, digits = 3),
  ) %>% 
  # add_global_p() %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  as_gt() %>%
  gt::tab_source_note(gt::md("*Best set of dependent variables*"))%>%
  gt::gtsave(filename = "frpq.pdf")
  # gt::gtsave(filename = "frpq.rtf")

# full model
finalmodel_dataset3 <- dat %>%
  mutate(fpq_score = `fair research practices score`
         )%>%
  # dplyr::select(fpq_score, Location, var_selected) %>%
  mutate(accademic_rank = as.factor(`What is your highest academic rank?`),
         year_involment_research = as.factor(`How many years of involvement in research do you have?`),
         gender = as.factor(`What is you gender?`),
         country_origin = as.factor(`Which country are you from?`),
         discipline_global_health = as.factor(`What discipline of global health based describes you:`)
         ) %>%
  dplyr::select(fpq_score, Location, accademic_rank, year_involment_research, gender, country_origin, discipline_global_health)
model2 <- glm(formula = as.formula('fpq_score~ Location + accademic_rank + year_involment_research + gender + country_origin + discipline_global_health'),
              data = finalmodel_dataset3,
              family = gaussian,
              )

model2 %>%
  tbl_regression(
    estimate_fun = purrr::partial(style_ratio, digits = 2),# exponentiate = F, 
    pvalue_fun = ~style_pvalue(.x, digits = 3),
  ) %>% 
  # add_global_p() %>%
  bold_p(t = 0.05) %>%
  bold_labels() %>%
  italicize_levels() %>%
  as_gt() %>%
  gt::tab_source_note(gt::md("*Full model*"))%>%
  gt::gtsave(filename = "frpq-full_model.pdf")
  # gt::gtsave(filename = "frpq-full_model.rtf")
```

At Univariate analysis, coming from the global north was associated with -10 (95%CI:-19, -1.6)	(P = 0.022) reduction the fair research practices scores compared to respondent from global south, while those who preferred not to say their number of years of involvement in research  had a -55	(95%CI:-101, -8.1)	(P = 0.023) reduction in fair research practices scores compared to Early Career (< 3 years post-education). Respondent from the sub-Saharan region had a 15 (95%CI:0.24, 29)	(P = 0.049) increase in fair research practices scores compared to those from East Asia and Pacific. Other variables were not statistically significantly associated with fair research practices. 
In the full model, after adjusting for Location, years of involvement, gender, country of origin and discipline of global health, respondents who preferred not to disclose their years of involvement in research had a -50.0 (95%CI:-98.7, -1.25)	(P = 0.048) reduction in the fair research scores compared to Early Career (< 3 years post-education). While in the reduced model (after stepwise regression analysis) respondents who preferred not to disclose their years of involvement in research had a -59.0 (95%CI:-104, -14.1)	(P = 0.012) reduction in the fair research scores compared to Early Career (< 3 years post-education) after adjusting for location and global north respondents had a -13.1 (95%CI:-21.9, -4.42) (P = 0.004) reduction in the fair research practices score compared to the global south adjusting for year of involvement.. 

# Analysis for those who responded N/A
In this analysis, I have only tabulated those who said N/A in any of the 40 questions
```{r, message = FALSE, cache = TRUE, warning=FALSE, echo = FALSE, results='asis'}

dt1 <- final_dataset %>%
    dplyr::select(`responsible research Practices_q1`, `na_responsible research Practices_q1`, `Which of the following best describes you?`) %>%
    filter(`responsible research Practices_q1` == 'N/A') %>%
    dplyr::select(`na_responsible research Practices_q1`, `Which of the following best describes you?`) %>% #x[i], 
    tbl_summary(by = `Which of the following best describes you?`,
            # missing = "no",
            # statistic = list(all_continuous() ~ "{mean} ({sd})")
            ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels() 
dt1
# flextable::set_table_properties(dt1, width = .01, layout = "autofit")%>% autofit() %>% fit_to_width(7.5)

dt2 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q2`, `na_responsible research Practices_q2`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q2` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q2`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
# dt2
flextable::set_table_properties(dt2, layout = "autofit")

dt3 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q3`, `na_responsible research Practices_q3`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q3` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q3`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt3

dt4 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q4`, `na_responsible research Practices_q4`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q4` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q4`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt4
dt5 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q5`, `na_responsible research Practices_q5`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q5` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q5`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt5
dt6 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q6`, `na_responsible research Practices_q6`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q6` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q6`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt6
dt7 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q7`, `na_responsible research Practices_q7`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q7` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q7`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt7
dt8 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q8`, `na_responsible research Practices_q8`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q8` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q8`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt8
dt9 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q9`, `na_responsible research Practices_q9`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q9` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q9`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt9
dt10 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q10`, `na_responsible research Practices_q10`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q10` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q10`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt10
dt11 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q11`, `na_responsible research Practices_q11`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q11` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q11`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt11
dt12 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q12`, `na_responsible research Practices_q12`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q12` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q12`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt12
dt13 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q13`, `na_responsible research Practices_q13`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q13` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q13`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt13
dt14 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q14`, `na_responsible research Practices_q14`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q14` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q14`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt14
dt15 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q15`, `na_responsible research Practices_q15`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q15` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q15`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt15
dt16 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q16`, `na_responsible research Practices_q16`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q16` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q16`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt16
dt17 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q17`, `na_responsible research Practices_q17`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q17` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q17`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt17
dt18 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q18`, `na_responsible research Practices_q18`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q18` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q18`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt18
dt19 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q19`, `na_responsible research Practices_q19`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q19` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q19`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt19
dt20 <- final_dataset %>%
  dplyr::select(`responsible research Practices_q20`, `na_responsible research Practices_q20`, `Which of the following best describes you?`) %>%
  filter(`responsible research Practices_q20` == 'N/A') %>%
  dplyr::select(`na_responsible research Practices_q20`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt20

```

```{r, message = FALSE, cache = TRUE, warning=FALSE, echo = FALSE, results='asis'}
dt1 <- final_dataset %>%
  dplyr::select(`fair research practices_q1`, `na_fair research practices_q1`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q1` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q1`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt1

dt2 <- final_dataset %>%
  dplyr::select(`fair research practices_q2`, `na_fair research practices_q2`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q2` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q2`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt2

dt3 <- final_dataset %>%
  dplyr::select(`fair research practices_q3`, `na_fair research practices_q3`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q3` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q3`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt3

dt4 <- final_dataset %>%
  dplyr::select(`fair research practices_q4`, `na_fair research practices_q4`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q4` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q4`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt4
dt5 <- final_dataset %>%
  dplyr::select(`fair research practices_q5`, `na_fair research practices_q5`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q5` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q5`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt5
dt6 <- final_dataset %>%
  dplyr::select(`fair research practices_q6`, `na_fair research practices_q6`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q6` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q6`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt6
dt7 <- final_dataset %>%
  dplyr::select(`fair research practices_q7`, `na_fair research practices_q7`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q7` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q7`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt7
dt8 <- final_dataset %>%
  dplyr::select(`fair research practices_q8`, `na_fair research practices_q8`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q8` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q8`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt8
dt9 <- final_dataset %>%
  dplyr::select(`fair research practices_q9`, `na_fair research practices_q9`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q9` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q9`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt9
dt10 <- final_dataset %>%
  dplyr::select(`fair research practices_q10`, `na_fair research practices_q10`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q10` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q10`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt10
dt11 <- final_dataset %>%
  dplyr::select(`fair research practices_q11`, `na_fair research practices_q11`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q11` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q11`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt11
dt12 <- final_dataset %>%
  dplyr::select(`fair research practices_q12`, `na_fair research practices_q12`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q12` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q12`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt12
dt13 <- final_dataset %>%
  dplyr::select(`fair research practices_q13`, `na_fair research practices_q13`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q13` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q13`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt13
dt14 <- final_dataset %>%
  dplyr::select(`fair research practices_q14`, `na_fair research practices_q14`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q14` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q14`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt14
dt15 <- final_dataset %>%
  dplyr::select(`fair research practices_q15`, `na_fair research practices_q15`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q15` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q15`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt15
dt16 <- final_dataset %>%
  dplyr::select(`fair research practices_q16`, `na_fair research practices_q16`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q16` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q16`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt16
dt17 <- final_dataset %>%
  dplyr::select(`fair research practices_q17`, `na_fair research practices_q17`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q17` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q17`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt17
dt18 <- final_dataset %>%
  dplyr::select(`fair research practices_q18`, `na_fair research practices_q18`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q18` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q18`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt18
dt19 <- final_dataset %>%
  dplyr::select(`fair research practices_q19`, `na_fair research practices_q19`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q19` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q19`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt19
dt20 <- final_dataset %>%
  dplyr::select(`fair research practices_q20`, `na_fair research practices_q20`, `Which of the following best describes you?`) %>%
  filter(`fair research practices_q20` == 'N/A') %>%
  dplyr::select(`na_fair research practices_q20`, `Which of the following best describes you?`) %>% #x[i], 
  tbl_summary(by = `Which of the following best describes you?`,
    # missing = "no",
    # statistic = list(all_continuous() ~ "{mean} ({sd})")
  ) %>%
  # add_p() %>%
  add_n() %>% 
  modify_header(label = "Variable") %>% # update the column header
  bold_labels()
dt20

```

